@model BiraFit.Models.IndexViewModel
@using Microsoft.AspNet.Identity.Owin;

@{
    ViewBag.Title = "Verwalten";
    var user = Request.GetOwinContext().GetUserManager<ApplicationUserManager>().FindByNameAsync(User.Identity.Name).Result;
    var image = "~/Resources/AccountPicture/" + user.ProfilBild;
}

<body id="profileBack">
    <div class="container" id="accountBox">
        <div id="mybox" class="col-md-6 col-md-offset-3 modal-content">
            <div class="panel panel-info" id="innerbox">
                <div class="panel-heading" id="boxHead">
                    <div class="panel-title">
                        <h4>Mein Account</h4>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="col-md-3 col-lg-3" align="center">
                                @if (user.ProfilBild != null)
                                {
                                    <img class="img-circle" id="profileImg" src="@Url.Content(image)" />
                                }
                                else
                                {
                                    <img class="img-circle" id="profileImg" src="~/Resources/default-avatar-c5d8ec086224cb6fc4e395f4ba3018c2.jpg" />
                                }
                                <a data-toggle="modal" href="#profileChangePopUp" id="link">Profilbild ändern</a>
                            </div>
                            <div class="col-md-9 col-lg-9">
                                <table class="table table-user-information">
                                    <tbody>
                                        <tr>
                                            <td>Vorname:</td>
                                            <td>@user.Vorname</td>
                                        </tr>
                                        <tr>
                                            <td>Nachname:</td>
                                            <td>@user.Name</td>
                                        </tr>
                                        <tr>

                                            <td>Email</td>
                                            <td>
                                                <a href="mailto:@User.Identity.Name" id="link">@user.Email</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Kennwort</td>
                                            <td>
                                                @Html.ActionLink("Kennwort ändern", "ChangePassword", "Manage", routeValues: null, htmlAttributes: new { id = "link" })
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                    </div>
                </div>
                <div class="panel-footer" id="footerBox">
                    <a href="/Manage/Edit" class="btn btn-primary" id="loginButton">Profil bearbeiten</a>
                    <a data-toggle="modal" href="#deletePopUp" class="btn btn-primary" id="delButton">Profil löschen</a>
                    @Html.ActionLink("Show Profile", "Show", new {id = "4331f5fb-8967-4bd4-85ee-e9132dbc801a" })

                </div>

            </div>
        </div>
    </div>

    <div id="profileChangePopUp" class="modal fade">
        @Html.Partial("UploadFile");
    </div>

    <div id="deletePopUp" class="modal fade">
        @Html.Partial("Delete");
    </div>


</body>